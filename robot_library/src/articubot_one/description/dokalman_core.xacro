<?xml version="1.0" encoding="utf-8"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:include filename="inertial_macros.xacro"/>

  <!-- PROPERTIES -->
  <xacro:property name="wheel_radius" value="0.15"/>
  <xacro:property name="wheel_thickness" value="0.032"/>
  <xacro:property name="wheel_mass" value="0.15"/>
  <xacro:property name="wheel_offset_x" value="0.30175"/>
  <xacro:property name="wheel_offset_y" value="0.2427"/>
  <xacro:property name="wheel_offset_z" value="0.26683"/>


  <!-- MATERIALS -->
  <material name="white">
      <color rgba="1 1 1 1" />
  </material>

  <material name="orange">
      <color rgba="1 0.3 0.1 1"/>
  </material>

  <material name="blue">
      <color rgba="0.2 0.2 1 1"/>
  </material>

  <material name="black">
      <color rgba="0 0 0 1"/>
  </material>

  <material name="red">
      <color rgba="1 0 0 1"/>
  </material>


  <!-- BASE LINK -->
  <link name="base_link"/>


  <!-- BASE_FOOTPRINT LINK -->
  <joint name="base_footprint_joint" type="fixed">
      <parent link="base_link"/>
      <child link="base_footprint"/>
      <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>

  <link name="base_footprint"/>


  <!-- CHASSIS -->
  <joint name="dokalman_chassis_joint" type="fixed">
    <parent link="base_link"/>
    <child link="ChassisLink"/>
    <origin xyz="0 0 0" rpy="0 0 0"/>
  </joint>
  <link name="ChassisLink">
    <inertial>
      <origin
        xyz="0 0 0.042916"
        rpy="0 0 -1.5708" />
      <parent
        link="base_link" />
      <mass
        value="3.8804" />
      <inertia
        ixx="0.46922"
        ixy="0"
        ixz="0"
        iyy="0.43543"
        iyz="-0.0081395"
        izz="0.28753" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 -1.5708" />
      
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/base_link.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 -1.5708" />
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/base_link.STL" />
      </geometry>
    </collision>
  </link>

  <!-- BACK LEFT WHEEL -->
  <joint name="left_wheel_joint" type="continuous">
      <parent link="base_link"/>
      <child link="left_wheel"/>
      <origin xyz="0 ${wheel_offset_y} 0" rpy="-${pi/2} 0 0" />
      <axis xyz="0 0 1"/>
  </joint>

  <link name="left_wheel">
      <visual>
          <geometry>
              <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
          </geometry>
          <material name="blue"/>
      </visual>
      <collision>
          <geometry>
              <sphere radius="${wheel_radius}"/>
          </geometry>
      </collision>
      <xacro:inertial_cylinder mass="${wheel_mass}" length="${wheel_thickness}" radius="${wheel_radius}">
          <origin xyz="0 0 0" rpy="0 0 0"/>
      </xacro:inertial_cylinder>
  </link>

  <gazebo reference="left_wheel">
      <material>Gazebo/Blue</material>
  </gazebo>

  <!-- BACK RIGHT WHEEL -->
  <joint name="right_wheel_joint" type="continuous">
        <parent link="base_link"/>
        <child link="right_wheel"/>
        <origin xyz="0 ${-wheel_offset_y} 0" rpy="${pi/2} 0 0" />
        <axis xyz="0 0 -1"/>
    </joint>

    <link name="right_wheel">
        <visual>
            <geometry>
                <cylinder radius="${wheel_radius}" length="${wheel_thickness}"/>
            </geometry>
            <material name="blue"/>
        </visual>
        <collision>
            <geometry>
                <sphere radius="${wheel_radius}"/>
            </geometry>
        </collision>
        <xacro:inertial_cylinder mass="${wheel_mass}" length="${wheel_thickness}" radius="${wheel_radius}">
            <origin xyz="0 0 0" rpy="0 0 0"/>
        </xacro:inertial_cylinder>
    </link>

    <gazebo reference="right_wheel">
        <material>Gazebo/Blue</material>
    </gazebo>

  <!-- CASTER -->
  <link name="CasterLink">
    <inertial>
      <origin
        xyz="0 -0.036462 0.035808"
        rpy="0 0 0" />
      <mass
        value="0.37248" />
      <inertia
        ixx="0.0013774"
        ixy="0"
        ixz="0"
        iyy="0.0026235"
        iyz="0.0003954"
        izz="0.0020896" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/CasterLink.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/CasterLink.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="CasterJoint" type="continuous">
    <origin
      xyz="0.3302 0 -0.21908"
      rpy="1.5708 0 -1.5708" />
    <parent
      link="base_link" />
    <child
      link="CasterLink" />
    <axis
      xyz="0 1 0" />
    <limit
      lower="0"
      upper="3.1415"
      effort="1"
      velocity="1" />
  </joint>

  <!-- FRONT LEFT WHEEL -->
  <link name="FrontLeftWheelLink">
    <inertial>
      <origin
        xyz="-0.024699 0 0"
        rpy="0 0 0" />
      <mass
        value="1.1605" />
      <inertia
        ixx="0.0053422"
        ixy="0"
        ixz="0"
        iyy="0.0028032"
        iyz="0"
        izz="0.0028787" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/FrontLeftWheelLink.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/FrontLeftWheelLink.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="FrontLeftWheelJoint" type="continuous">
    <origin
      xyz="-0.083806 -0.10265 0.10795"
      rpy="1.1883 0 0" />
    <parent
      link="CasterLink" />
    <child
      link="FrontLeftWheelLink" />
    <axis
      xyz="1 0 0" />
    <limit
      lower="0"
      upper="3.1415"
      effort="1"
      velocity="1" />
  </joint>

  <!-- FRONT RIGHT WHEEL -->
  <link name="FrontRightWheelLink">
    <inertial>
      <origin
        xyz="0.024604 0 0"
        rpy="0 0 0" />
      <mass
        value="1.1605" />
      <inertia
        ixx="0.0053422"
        ixy="0"
        ixz="0"
        iyy="0.0028032"
        iyz="0"
        izz="0.0028787" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/FrontRightWheelLink.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="file://$(find articubot_one)/meshes/FrontRightWheelLink.STL" />
      </geometry>
    </collision>
  </link>
  <joint name="FrontRightWheelJoint" type="continuous">
    <origin
      xyz="0.083901 -0.10265 0.10795"
      rpy="-1.8971 0 0" />
    <parent
      link="CasterLink" />
    <child
      link="FrontRightWheelLink" />
    <axis
      xyz="1 0 0" />
    <limit
      lower="0"
      upper="3.1415"
      effort="1"
      velocity="1" />
  </joint>
</robot>